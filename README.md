# ASM - Attack Surface Mapper

## Description

ASM is a Python-based tool designed to help security professionals and researchers map and analyze the attack surface of a target. It integrates several security scanning functionalities into a single, easy-to-use command-line interface.  The tool currently includes:

* **Port Scanning:** Identifies open ports on a target system.
* **Technology Fingerprinting:** Detects technologies used by a website.
* **Vulnerability Detection:** Scans for potential vulnerabilities in a web application.
* **Subdomain Takeover Detection:** Identifies subdomains that may be vulnerable to takeover.
* **Asset Discovery:** Discovers and analyzes assets associated with a target.

## Features

* **Modular Design:** Each scanning function is implemented as a separate Python script.
* **Command-Line Interface (CLI):** Provides a simple and intuitive way to run scans.
* **Data Output:** Scan results can be viewed in the terminal or saved to JSON, CSV, or PDF files.
* **Sublist3r Integration:** Uses the third-party tool Sublist3r for subdomain discovery.
* **Shodan Integration:** (Optional)  Fetches information about discovered assets from Shodan (requires API key).

## Setup

### Prerequisites

* Python 3.x
* pip (Python package installer)
* Sublist3r (included in the repository)
* Optional: Shodan API key (for asset discovery)
* Optional: `fpdf` (for PDF output). Install via `pip install fpdf`

### Installation

1.  **Clone the repository:**

    ```bash
    git clone <repository_url>
    cd ASM
    ```

2.  **Create a virtual environment (Recommended):**

    ```bash
    python -m venv venv  # Or: python3 -m venv venv
    ```

3.  **Activate the virtual environment:**

    * On Windows:

        ```bash
        .\venv\Scripts\activate
        ```

    * On macOS and Linux:

        ```bash
        source ./venv/bin/activate
        ```

4.  **Install dependencies:**

    ```bash
    pip install -r requirements.txt
    ```

5.  **Set up Sublist3r:**

    * Sublist3r is included in the repository.  No separate installation is needed.

6.  **Set up Shodan API key (Optional):**

    * If you want to use the asset discovery feature with Shodan, you need to:
        * Obtain an API key from Shodan: [https://developer.shodan.io/](https://developer.shodan.io/)
        * Create a `.env` file in the `ASM` directory.
        * Add the following line to the `.env` file, replacing `<your_shodan_api_key>` with your actual API key:

            ```
            SHODAN_API_KEY=<your_shodan_api_key>
            ```

## Usage

1.  **Activate the virtual environment** (if you created one):

    * On Windows:

        ```bash
        .\venv\Scripts\activate
        ```

    * On macOS and Linux:

        ```bash
        source ./venv/bin/activate
        ```

2.  **Run the `cli.py` script:**

    ```bash
    python cli.py
    ```

3.  **Follow the on-screen menu to select a scan and provide the necessary input.**

###   Subdomain Takeover Scan Notes

* The Subdomain Takeover scan requires the `subdomains.txt` file, which is generated by Sublist3r.
* If `subdomains.txt` is not found, the CLI will instruct you to run Sublist3r manually:

    ```bash
    python ./Sublist3r/sublist3r.py -d <target_domain> -o subdomains.txt
    ```

    * Replace `<target_domain>` with the domain you want to scan for subdomain takeovers (e.g., `example.com`).
    * Run this command in a separate terminal.
    * After Sublist3r completes and `subdomains.txt` is created, return to the `cli.py` terminal and press Enter to continue the Subdomain Takeover scan.

###   Saving Results

* After a scan, you can choose to save the results.
* Supported output formats are:

    * **JSON:** Saves the raw scan data in JSON format.
    * **CSV:** Saves the scan data in CSV format.
    * **PDF:** Saves the scan data in a basic PDF format.

##  Documentation of Scripts

###   `cli.py`

* The main script that provides the command-line interface.
* Allows users to select a scan type, provide input, view results, and save results.
* Orchestrates the execution of the other scan scripts.

###   `port_scanner.py`

* Implements port scanning functionality.
* Accepts a target IP address or domain.
* Identifies open ports and services.
* If the target is a file, it will read targets from the file.

###   `tech_fingerprints.py`

* Performs technology fingerprinting on a given URL.
* Identifies the technologies used to build the website.

###   `vuln_detection.py`

* Scans a URL for potential vulnerabilities.

###   `subdomain_takeover.py`

* Detects subdomains that are potentially vulnerable to takeover.
* Relies on the third-party tool Sublist3r to generate the `subdomains.txt` file.

###   `assest_discovery.py`

* Discovers and analyzes assets associated with a target URL or domain.
* Uses Sublist3r for subdomain discovery.
* Optionally uses Shodan to gather information about discovered assets.

##  Dependencies

* `dnspython`
* `requests`
* `json`
* `ipaddress`
* `beautifulsoup4`
* `dotenv`
* `shodan` (Optional, for asset discovery)
* `fpdf` (Optional, for PDF output)

##   Contributing

* Feel free to contribute to this project by submitting pull requests.
* Please follow the existing code style and provide clear commit messages.

##   License

* GNU GENERAL PUBLIC LICENSE

##   Disclaimer

* This tool is intended for ethical security testing and research purposes only.
* Use it responsibly and only on systems you have explicit permission to test.
* The authors are not responsible for any misuse of this tool.